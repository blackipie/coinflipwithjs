<!DOCTYPE html>
<html>
  <head>
    <title>Coin Flip!</title>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
    <style>body{font-family:'Poppins',sans-serif;}h1{font-size:4vw;text-align:center;margin-bottom:0;margin-top:1.5%;text-shadow:2px 2px grey;}h2{margin-left:5%;font-size:2vw;text-shadow:.5px .5px grey;}input:focus,textarea:focus{outline:none;}input{margin-left:42.5%;margin-right:42.5%;width:15%;transition:all .5s linear;}#coin_fall{animation:coin_fall 4s infinite;position:fixed;}#falling_coin{width:100px;animation:infinite-spinning 4s infinite;margin:0;}@keyframes coin_fall{0%{transform:translate(0,-20%)}100%{transform:translate(0,1000%)}}#div{margin:0;}@keyframes infinite-spinning{from{transform:rotateX(0deg)}to{transform:rotateX(720deg)}}#score_box{width:20%;border-style:solid;float:right;margin-right:5%;box-shadow:10px 10px 5px #888888;}#tally{font-size:2vw;margin-top:3%;margin-bottom:0;text-align:center;text-decoration:underline;}ul li{font-size:1.5vw;list-style-type:none;display:inline;}ul{margin:1%;}input:active{transform:rotateX(1800deg) scale(4);}#final_winner{-webkit-animation:flash linear 1s infinite;animation:flash linear 1s infinite;}@-webkit-keyframes flash{0%{opacity:1}50%{opacity:.1}100%{opacity:1}}@keyframes flash{0%{opacity:1}50%{opacity:.1}100%{opacity:1}}</style>
  </head>
  <body>
    <div id= "damn"></div>
    <div id="score_box">
      <p id="tally">Tally</p>
      <ul>
        <li> Heads: </li>
        <li id="head_win"></li>
      </ul>
      <ul>
        <li> Tails: </li>
        <li id="tail_win"></li>
      </ul>
    </div>
    <h5> Welcome to Heads Or Tails! </h5>
    <input id="coin" type="image" src="images/heads.png" onclick="coinFlip(); score(); play();"/>
    <h3 id="winner" style="color: rgb(119, 77, 235);text-align: center; font-family: 'Courier New', Courier, monospace;"></h3>
    <h3 id="final_winner" style="color: blueviolet;text-align: center; font-family: 'Courier New', Courier, monospace;"></h3>
    <p> 1) Player one clicks on the coin to flip it. </p>
    <p> 2) Then player two clicks and so on until you reach the turn limit (9 times). </p>
    <p> 3) The winner is the player who won the majority of coin flips!</p>
    <p> 4) Now flip it!</p>
    <audio id="audio" src="coin_toss.mp3"></audio>
    <script>
     var heads_wins = [];
var tails_wins = [];

function play(){
       var audio = document.getElementById("audio");
       audio.play();
}

function coinFlip() {
		function flip(){
				return Math.floor((Math.random() * 2) + 1)
		}
		var result = flip();
		if (result === 1){
				document.getElementById("coin").src="images/heads.png";
				winner = `HEADS`;
				head_win = heads_wins.push(result);
        document.getElementById("head_win").innerText = head_win;
		} else if (result === 2) {
				document.getElementById("coin").src="images/tails.png";
				winner = `TAILS`;
			  tail_win = `${tails_wins.push(result)}`;
        document.getElementById("tail_win").innerText = tail_win;
		}
		document.getElementById("winner").innerText = winner;
	}

	function score(){
		if (heads_wins.length + tails_wins.length === 9){
			if (heads_wins.length > tails_wins.length){
				document.getElementById("coin").src="images/heads.png";
				final_winner = `The winner is HEADS with ${heads_wins.length} wins!`;
        print_winner();
			} else if (tails_wins.length > heads_wins.length) {
				document.getElementById("coin").src="images/tails.png";
				final_winner = `The winner is TAILS with ${tails_wins.length} wins!`;
        print_winner();
			}
		}
	}

  function print_winner(){
    winner = ''
    document.getElementById("final_winner").innerHTML = final_winner;
    // debugger;
    fallingCoins()
    // setTimeout(playAgain, 4000);
  }

  function playAgain(){
    alert("Play again?");
    window['location'].reload();
  }

  function addCoin() {
    var coin_div = document.getElementById('coin_fall')
    var rand = Math.floor(Math.random() * 1000) + 1
    coin_div.style.position = "fixed";
    coin_div.style.top = '-120px';
    coin_div.style.left = rand +'px';
    var clone = coin_div.cloneNode(true);
    document.body.appendChild(clone);
  }

  function fallingCoins(){
    var arr = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    if (heads_wins.length > tails_wins.length){
      document.getElementById("damn").innerHTML += "<div id='coin_fall'><img id='falling_coin' src='images/heads.png'/></div>"
    } else {
      document.getElementById("damn").innerHTML += "<div id='coin_fall'><img id='falling_coin' src='images/tails.png'/></div>"
    }
     // true means clone all childNodes and all event handlers
    for (var i = 0; i < arr.length; i++) {
      var rand = Math.floor(Math.random() * 3) + 2;
      setTimeout(addCoin, (i * rand) * 300);
    }

  }
 
    </script>
  </body>
</html>
